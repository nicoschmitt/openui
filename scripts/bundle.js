"use strict";function setUserName(t){global.user||(global.user=t,document.title="["+t+"] "+document.title)}function startTimers(){window.setInterval(function(){global.connected&&global.ws.emit("player_stats")},3e5),window.setInterval(function(){global.connected&&global.map.updatePokestopsStatus()},6e4)}function startListenToSocket(){inventory.init(global.config.locale),console.log("Connecting to "+global.config.websocket),startTimers();var t=localStorage.getItem("pokemonSettings");t?global.pokemonSettings=JSON.parse(t):global.pokemonSettings={};var e=io.connect(global.config.websocket+"/event");global.ws=e,e.on("connect",function(){console.log("Connected to Bot"),global.connected=!0,$(".loading").text("Waiting to get GPS coordinates from Bot...")}),e.on("disconnect",function(){global.connected=!1}),e.on("bot_initialized",function(t){t.username&&(console.log("Bot Ready."),console.log(t),setUserName(t.username),global.player=t.player,global.player&&($(".player").trigger("pogo:player_update"),ga("send","event","level",global.player.level)),t.storage&&(global.storage={pokemon:t.storage.max_pokemon_storage,items:t.storage.max_item_storage}),global.map.addToPath({lat:t.coordinates[0],lng:t.coordinates[1]})),$(".toolbar div").show(),global.ws.emit("pokemon_settings")}),e.on("pokemon_settings",function(t){global.pokemonSettings=t,localStorage.setItem("pokemonSettings",JSON.stringify(global.pokemonSettings))}),e.on("player_stats",function(t){global.player=t.player,$(".player").trigger("pogo:player_update")}),e.on("position",function(t){global.snipping||global.map.addToPath({lat:t.coordinates[0],lng:t.coordinates[1]})}),e.on("pokestops",function(t){var e=Array.from(t.pokestops.filter(function(t){return 1==t.fort_type}),function(t){return{id:t.fort_id,lat:t.latitude,lng:t.longitude,cooldown:parseInt(t.cooldown_timestamp_ms)||null,lureExpire:parseInt(t.lure_expires_timestamp_ms)||null}});global.map.addPokestops(e)}),e.on("pokestop_visited",function(t){console.log("Pokestop Visited"),global.map.addVisitedPokestop({id:t.pokestop.fort_id,name:"",lat:t.pokestop.latitude,lng:t.pokestop.longitude,cooldown:parseInt(t.pokestop.cooldown_timestamp_ms)||null,lureExpire:parseInt(t.pokestop.lure_expires_timestamp_ms)||null,visited:!0})}),e.on("pokemon_caught",function(t){console.log("Pokemon caught");var e=t.pokemon,o={id:e.pokemon_id,name:inventory.getPokemonName(e.pokemon_id),cp:e.combat_power,iv:(100*e.potential).toFixed(1),lvl:inventory.getPokemonLevel(e)};t.position&&(o.lat=t.position.latitude,o.lng=t.position.longitude),global.map.addCatch(o),pokemonToast(o,{ball:e.pokeball})}),e.on("pokemon_evolved",function(t){var e={id:t.evolution,name:inventory.getPokemonName(t.evolution)},o=inventory.getPokemonName(t.pokemon.pokemon_id);pokemonToast(e,{title:"A "+o+" Evolved"})}),e.on("inventory_list",function(t){var e=Array.from(Object.keys(t.inventory).filter(function(t){return"count"!=t}),function(e){var o=parseInt(e);return{item_id:o,name:inventory.getItemName(o),count:t.inventory[e]}});global.map.displayInventory(e)}),e.on("pokemon_list",function(t){var e=Array.from(t.pokemon,function(e){var o=global.pokemonSettings[e.pokemon_id-1]||{};return{id:e.unique_id,pokemonId:e.pokemon_id,inGym:null!=e.deployed_fort_id,canEvolve:o.evolution_ids&&o.evolution_ids.length>0,cp:e.combat_power,iv:(100*e.potential).toFixed(1),lvl:inventory.getPokemonLevel(e),name:e.nickname||inventory.getPokemonName(e.pokemon_id),candy:t.candy[o.family_id]||0,candyToEvolve:o.candy_to_evolve,favorite:"True"==e.favorite,stats:{atk:e.attack,def:e.defense,hp:e.hp,maxHp:e.max_hp,sta:e.stamina}}});global.map.displayPokemonList(e,null,t.eggs_count)}),e.on("eggs_list",function(t){t.km_walked=t.km_walked||0;var e=t.egg_incubators.filter(function(t){return 0!=t.target_km_walked||0!=t.start_km_walked});e=Array.from(e,function(e){return{type:901==e.item_id?"incubator-unlimited":"incubator",totalDist:e.target_km_walked-e.start_km_walked,doneDist:t.km_walked-e.start_km_walked}});var o=Array.from(t.egg_incubators,function(t){return t.pokemon_id}),n=Array.from(t.eggs.filter(function(t){return o.indexOf(t.unique_id)<0}),function(t){return{type:"egg",totalDist:t.total_distance,doneDist:t.walked_distance}});global.map.displayEggsList(e.concat(n))}),e.on("route",function(t){global.map.setRoute(Array.from(t,function(t){return{lat:t[0],lng:t[1]}}))}),e.on("manual_destination_reached_event",function(){global.map.manualDestinationReached()})}function errorToast(t){toastr.error(t,"Error",{progressBar:!0,positionClass:"toast-top-right",timeOut:"5000",closeButton:!0})}function pokemonToast(t,e){if(!global.config.noPopup){e=e||{};var o=e.title||(global.snipping?"Snipe success":"Catch success"),n=global.snipping?toastr.success:toastr.info,i=t.name;t.lvl&&(i+=" (lvl "+t.lvl+")");var a="<div>"+i+"</div><div>";a+="<img src='./assets/pokemon/"+t.id+".png' height='50' />",e.ball&&(a+="<img src='./assets/inventory/"+e.ball+".png' height='30' />"),a+="</div>",n(a,o,{progressBar:!0,positionClass:"toast-top-right",timeOut:5e3,closeButton:!0})}}!function(){var t=null,e=null,o={};o.init=function(o,n){o=o||"en",$.when($.ajax({url:"assets/json/pokemon."+o+".json",success:function(e){t="string"==typeof e?JSON.parse(e):e}}),$.ajax({url:"assets/json/inventory."+o+".json",success:function(t){e="string"==typeof t?JSON.parse(t):t}})).then(n)},o.getPokemonName=function(e){return t[e]},o.getItemName=function(t){return e[t]};var n={93:1,94:1,135:1.5,166:2,192:2.5,215:3,236:3.5,255:4,273:4.5,290:5,306:5.5,321:6,335:6.5,349:7,362:7.5,375:8,387:8.5,399:9,411:9.5,422:10,432:10.5,443:11,453:11.5,462:12,472:12.5,481:13,490:13.5,499:14,508:14.5,517:15,525:15.5,534:16,542:16.5,550:17,558:17.5,566:18,574:18.5,582:19,589:19.5,597:20,604:20.5,612:21,619:21.5,626:22,633:22.5,640:23,647:23.5,654:24,661:24.5,667:25,674:25.5,681:26,687:26.5,694:27,700:27.5,706:28,713:28.5,719:29,725:29.5,731:30,734:30.5,737:31,740:31.5,743:32,746:32.5,749:33,752:33.5,755:34,758:34.5,761:35,764:35.5,767:36,770:36.5,773:37,776:37.5,778:38,781:38.5,784:39,790:40};o.getPokemonLevel=function(t){var e=1e3*(t.combat_power_multiplier+t.additional_cp_multiplier);return n[0|e]},window.inventoryService=o}();var Map=function(t){var e=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),o=L.tileLayer("http://{s}.tile.opencyclemap.org/cycle/{z}/{x}/{y}.png"),n=L.tileLayer("http://{s}.tile2.opencyclemap.org/transport/{z}/{x}/{y}.png"),i=L.tileLayer("http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png"),a=L.tileLayer("http://{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.jpg");this.layerPokestops=new L.LayerGroup,this.layerCatches=L.markerClusterGroup({maxClusterRadius:30}),this.layerPath=new L.LayerGroup,this.map=L.map(t,{layers:[e,this.layerPokestops,this.layerCatches,this.layerPath]});var s={OpenStreetMap:e,OpenCycleMap:o,"OpenCycleMap Transport":n,Toner:i,Watercolor:a},l={Path:this.layerPath,Pokestops:this.layerPokestops,Catches:this.layerCatches};L.control.layers(s,l).addTo(this.map),this.map.on("baselayerchange",function(t){var e=t.name;localStorage.setItem("layer",e)}.bind(this));var r=localStorage.getItem("layer");r&&$(".leaflet-control-layers-base span:contains('"+r+"')").first().prev().click(),this.map.on("singleclick",function(t){this.setDestination(t.latlng)}.bind(this)),this.path=null,this.route=null,this.destination=null,this.steps=[],this.catches=[],this.pokestops=[],this.pokemonList=[]};Map.prototype.saveContext=function(){var t=Array.from(this.pokestops,function(t){return{id:t.id,lat:t.lat,lng:t.lng,visited:t.visited}});sessionStorage.setItem("available",!0),sessionStorage.setItem("steps",JSON.stringify(this.steps)),sessionStorage.setItem("catches",JSON.stringify(this.catches)),sessionStorage.setItem("pokestops",JSON.stringify(t))},Map.prototype.loadContext=function(){try{"true"==sessionStorage.getItem("available")&&(console.log("Load data from storage to restore session"),this.steps=JSON.parse(sessionStorage.getItem("steps"))||[],this.catches=JSON.parse(sessionStorage.getItem("catches"))||[],this.pokestops=JSON.parse(sessionStorage.getItem("pokestops"))||[],this.steps.length>0&&this.initPath(),this.initPokestops(),this.initCatches(),sessionStorage.setItem("available",!1))}catch(t){console.log(t)}},Map.prototype.initPath=function(){if(null!=this.path)return!0;if(!this.me){var t=this.steps[this.steps.length-1];this.map.setView([t.lat,t.lng],16),this.me=L.marker([t.lat,t.lng],{zIndexOffset:200}).addTo(this.map).bindPopup(t.lat.toFixed(4)+","+t.lng.toFixed(4)),$(".loading").hide()}if(this.steps.length>=2){var e=Array.from(this.steps,function(t){return L.latLng(t.lat,t.lng)});return this.path=L.polyline(e,{color:"red"}).addTo(this.layerPath),!0}return!1},Map.prototype.initCatches=function(){for(var t=0;t<this.catches.length;t++){var e=this.catches[t],o=L.icon({iconUrl:"./assets/pokemon/"+e.id+".png",iconSize:[60,60],iconAnchor:[30,30]}),n=e.name+" <br /> Cp:"+e.cp+" Iv:"+e.iv+"%";e.lvl&&(n=e.name+" (lvl "+e.lvl+") <br /> Cp:"+e.cp+" Iv:"+e.iv+"%"),L.marker([e.lat,e.lng],{icon:o,zIndexOffset:100}).bindPopup(n).addTo(this.layerCatches)}},Map.prototype.initPokestops=function(){for(var t=0;t<this.pokestops.length;t++){var e=this.pokestops[t],o=e.visited?"./assets/img/pokestop_visited.png":"./assets/img/pokestop_available.png",n=L.icon({iconUrl:o,iconSize:[40,40],iconAnchor:[20,20]});e.marker=L.marker([e.lat,e.lng],{icon:n,zIndexOffset:50}).bindPopup(e.name).addTo(this.layerPokestops)}},Map.prototype.addToPath=function(t){if(this.steps.push(t),global.config.memory.limit&&this.steps.length>global.config.memory.mathPath){this.layerPath.clearLayers(),this.path=null;var e=Math.floor(.7*global.config.memory.mathPath);this.steps=this.steps.slice(-e)}if(this.initPath()){var o=L.latLng(t.lat,t.lng);this.path.addLatLng(o),this.me.setLatLng(o).getPopup().setContent(t.lat.toFixed(4)+","+t.lng.toFixed(4)),global.config.followPlayer&&this.map.panTo(o,{animate:!0})}},Map.prototype.addCatch=function(t){if(!t.lat){if(this.steps.length<=0)return;var e=this.steps[this.steps.length-1];t.lat=e.lat,t.lng=e.lng}var o=t.name+"<br /> CP:"+t.cp+" IV:"+t.iv+"%";if(t.lvl&&(o=t.name+" (lvl "+t.lvl+") <br /> Cp:"+t.cp+" Iv:"+t.iv+"%"),this.catches.push(t),global.config.memory.limit&&this.catches.length>global.config.memory.maxCaught){console.log("Clean catches");var n=Math.floor(.7*global.config.memory.maxCaught);this.catches=this.catches.slice(-n),this.layerCatches.clearLayers(),this.initCatches()}else{var i=L.icon({iconUrl:"./assets/pokemon/"+t.id+".png",iconSize:[60,60],iconAnchor:[30,30]});L.marker([t.lat,t.lng],{icon:i,zIndexOffset:100}).bindPopup(o).addTo(this.layerCatches)}},Map.prototype.addVisitedPokestop=function(t){if(t.lat){var e=this.pokestops.find(function(e){return e.id==t.id});if(e)Object.assign(e,t);else{this.pokestops.push(t),e=t;var o=L.icon({iconUrl:"./assets/img/pokestop_cooldown.png",iconSize:[40,40],iconAnchor:[20,20]});t.marker=L.marker([t.lat,t.lng],{icon:o,zIndexOffset:50}).addTo(this.layerPokestops)}e.visited=!0,e&&e.marker&&(e.marker.setIcon(L.icon({iconUrl:"./assets/img/pokestop_cooldown.png",iconSize:[40,40],iconAnchor:[20,20]})),e.name&&e.marker.bindPopup(e.name))}},Map.prototype.addPokestops=function(t){for(var e=0;e<t.length;e++){var o=t[e],n=this.pokestops.find(function(t){return t.id==o.id});n?o=Object.assign(n,o):this.pokestops.push(o);var i="pokestop_available";if(o.cooldown&&moment(o.cooldown).isAfter()?i="pokestop_cooldown":o.lureExpire&&moment(o.lureExpire).isAfter()?i="pokestop_lure":o.visited&&(i="pokestop_visited"),o.marker)o.marker.setIcon(L.icon({iconUrl:"./assets/img/"+i+".png",iconSize:[40,40],iconAnchor:[20,20]}));else{var i=L.icon({iconUrl:"./assets/img/"+i+".png",iconSize:[40,40],iconAnchor:[20,20]});o.marker=L.marker([o.lat,o.lng],{icon:i,zIndexOffset:50}).addTo(this.layerPokestops)}}global.config.memory.limit&&this.pokestops.length>global.config.memory.maxPokestops},Map.prototype.updatePokestopsStatus=function(){this.pokestops.forEach(function(t){var e=!1;if(t.cooldown&&moment(t.cooldown).isBefore()?(t.cooldown=null,e=!0):t.lureExpire&&moment(t.lureExpire).isBefore()&&(t.lureExpire=null,e=!0),e){var o="pokestop_available";t.cooldown&&moment(t.cooldown).isAfter()?o="pokestop_cooldown":t.lureExpire&&moment(t.lureExpire).isAfter()?o="pokestop_lure":t.visited&&(o="pokestop_visited"),t.marker.setIcon(L.icon({iconUrl:"./assets/img/"+o+".png",iconSize:[40,40],iconAnchor:[20,20]}))}})},Map.prototype.setRoute=function(t){var e=Array.from(t,function(t){return L.latLng(t.lat,t.lng)});null!=this.route?this.route.setLatLngs(e):this.route=L.polyline(e,{dashArray:"5, 5",color:"red",opacity:.4}).addTo(this.layerPath)},Map.prototype.displayPokemonList=function(t,e,o){console.log("Pokemon list"),global.active="pokemon",this.pokemonList=t||this.pokemonList,this.eggsCount=o||this.eggsCount||0,e?localStorage.setItem("sortPokemonBy",e):e=localStorage.getItem("sortPokemonBy")||"cp","pokemonId"==e?this.pokemonList=this.pokemonList.sort(function(t,o){if(t[e]!=o[e])return t[e]-o[e];var n=o.cp!=t.cp?"cp":"iv";return o[n]-t[n]}):this.pokemonList=this.pokemonList.sort(function(t,o){if(t[e]!=o[e])return o[e]-t[e];if(t.pokemonId!=o.pokemonId)return t.pokemonId-o.pokemonId;var n="cp"==e?"iv":"cp";return o[n]-t[n]});var n=this.eggsCount+this.pokemonList.length;$(".inventory .numberinfo").text(n+"/"+global.storage.pokemon);var i=$(".inventory .data");i.html(""),this.pokemonList.forEach(function(t){var e=t.canEvolve&&!t.inGym&&t.candy>=t.candyToEvolve,o=e?"":"hide",n=e?"canEvolve":"",a=t.favorite?"hide":"",s=t.canEvolve?"":"style='display:none'",l=t.favorite?"set":"unset";i.append('\n            <div class="pokemon">\n                <div class="transfer" data-id=\''+t.id+'\'>\n                    <a title=\'(Un)Favorite\' href="#" class="favoriteAction"><img src="./assets/img/favorite_'+l+'.png" /></a>\n                    <a title=\'Transfer\' href="#" class="transferAction '+a+'"><img src="./assets/img/recyclebin.png" /></a>\n                    <a title=\'Evolve\' href="#" class="evolveAction '+o+'"><img src="./assets/img/evolve.png" /></a>\n                </div>\n                <span class="imgspan '+n+'"><img src="./assets/pokemon/'+t.pokemonId+'.png" /></span>\n                <span class="name">'+t.name+" lvl "+t.lvl+'</span>\n                <span class="info">CP: <strong>'+t.cp+"</strong> IV: <strong>"+t.iv+'%</strong></span>\n                <span class="info hide-on-small-only">ATK: <strong>'+t.stats.atk+"</strong> DEF: <strong>"+t.stats.def+"</strong> STA: <strong>"+t.stats.sta+'</strong></span>\n                <span class="info">Candy: '+t.candy+"<span "+s+">/"+t.candyToEvolve+"</span></span>\n            </div>\n        ")}),$(".pokemonsort").show(),$(".inventory").show().addClass("active")},Map.prototype.displayEggsList=function(t){console.log("Eggs list"),global.active="eggs",$(".inventory .sort").hide(),$(".inventory .numberinfo").text(t.length+"/9");var e=$(".inventory .data");e.html(""),t.forEach(function(t){t&&e.append('\n                <div class="egg">\n                    <span class="imgspan"><img src="./assets/inventory/'+t.type+'.png" /></span>\n                    <span>'+t.doneDist.toFixed(1)+" / "+t.totalDist.toFixed(1)+" km</span>\n                </div>\n            ")}),$(".inventory").show().addClass("active")},Map.prototype.displayInventory=function(t){console.log("Inventory list"),global.active="inventory",$(".inventory .sort").hide();var e=t.filter(function(t){return 901!=t.item_id}).reduce(function(t,e){return t+e.count},0);$(".inventory .numberinfo").text(e+"/"+global.storage.items);var o=$(".inventory .data");o.html(""),t.forEach(function(t){var e=901==t.item_id?"hide":"";o.append('\n            <div class="item">\n                <div class="transfer" data-id=\''+t.item_id+"' data-count='"+t.count+"'>\n                    <a title='Drop' href=\"#\" class=\"dropItemAction "+e+'"><img src="./assets/img/recyclebin.png" /></a>\n                </div>\n\n                <span class="count">x'+t.count+'</span>\n                <span class="imgspan"><img src="./assets/inventory/'+t.item_id+'.png" /></span>\n                <span class="info">'+t.name+"</span>\n            </div>\n        ")}),$(".inventory").show().addClass("active")},Map.prototype.setDestination=function(t){var e=L.popup().setLatLng(t).setContent("<div class='dest'>"+t.lat.toFixed(6)+", "+t.lng.toFixed(6)+'</div><div class="center-align"><a class="destBtn waves-effect waves-light btn">Go?</a></div>').openOn(this.map);$(".destBtn").click(function(){this.map.closePopup(e),console.log("Set destination: "+t.lat+", "+t.lng),this.destination&&this.layerPath.removeLayer(this.destination),this.destination=L.marker(t,{zIndexOffset:199,icon:new RedIcon}).bindPopup(t.lat+", "+t.lng).addTo(this.layerPath),global.ws.emit("set_destination",t)}.bind(this))},Map.prototype.manualDestinationReached=function(){this.layerPath.removeLayer(this.destination),this.destination=null};var RedIcon=L.Icon.Default.extend({options:{iconUrl:"assets/img/marker-icon-red.png"}});L.MarkerCluster.prototype.true_initialize=L.MarkerCluster.prototype.initialize,L.MarkerCluster.prototype.initialize=function(t,e,o,n){this.true_initialize(t,e,o,n),this.setZIndexOffset(200)},L.Evented.addInitHook(function(){this._singleClickTimeout=null,this.on("click",this._scheduleSingleClick,this),this.on("dblclick dragstart zoomstart",this._clearSingleClickTimeout.bind(this),this)}),L.Evented.include({_scheduleSingleClick:function(t){this._clearSingleClickTimeout(),this._singleClickTimeout=setTimeout(this._fireSingleClick.bind(this,t),500)},_fireSingleClick:function(t){t.originalEvent._stopped||this.fire("singleclick",L.Util.extend(t,{type:"singleclick"}))},_clearSingleClickTimeout:function(){null!=this._singleClickTimeout&&(clearTimeout(this._singleClickTimeout),this._singleClickTimeout=null)}});var inventory=window.inventoryService;!function(){function t(t,e){o.config.noConfirm?e():vex.dialog.confirm({message:t,callback:function(t){t&&e()}})}function e(){window.ga=window.ga||function(){};var e=localStorage.getItem("sortPokemonBy")||"cp";$("#sortBy"+e).addClass("active").siblings().removeClass("active"),$("#pokemonLink").click(function(){"1"==$(".inventory").css("opacity")&&$(".inventory .data .pokemon").length?$(".inventory").removeClass("active"):o.ws.emit("pokemon_list")}),$("#eggsLink").click(function(){"1"==$(".inventory").css("opacity")&&$(".inventory .data .egg").length?$(".inventory").removeClass("active"):o.ws.emit("eggs_list")}),$("#inventoryLink").click(function(){"1"==$(".inventory").css("opacity")&&$(".inventory .data .item").length?$(".inventory").removeClass("active"):o.ws.emit("inventory_list")}),$("#sortBypokemonId").click(function(){return o.map.displayPokemonList(null,"pokemonId")}),$("#sortBycp").click(function(){return o.map.displayPokemonList(null,"cp")}),$("#sortByiv").click(function(){return o.map.displayPokemonList(null,"iv")}),$("#sortBypokemonId, #sortBycp, #sortByiv").click(function(){$(this).hasClass("active")||$(this).toggleClass("active").siblings().removeClass("active")}),$(".inventory .refresh").click(function(){console.log("Refresh"),o.ws.emit(o.active+"_list")}),$(".inventory .close").click(function(){$(this).parent().removeClass("active"),$(".inventory .sort").hide()}),$(".message .close").click(function(){$(this).parent().hide()}),$(".close").click(function(){o.active=null}),$("#recycleLink").click(function(){sessionStorage.setItem("available",!1),window.location.reload()}),$("#settingsLink").click(function(){o.map.saveContext(),window.location="config.html"}),$(".inventory .data").on("click","a.transferAction",function(){var e=$(this).parent(),n=e.data().id,i=o.map.pokemonList.findIndex(function(t){return t.id==n}),a=o.map.pokemonList[i],s=o.map.pokemonList.filter(function(t){return t.pokemonId==a.pokemonId}).length-1,l=inventoryService.getPokemonName(a.pokemonId),r="Are you sure you want to transfer this "+l+"? <br /> You will have <b>"+s+"</b> left.";t(r,function(){ga("send","event","transfer",l),o.ws.emit("transfer_pokemon",{id:n}),o.map.pokemonList.splice(i,1),e.parent().fadeOut()})}),$(".inventory .data").on("click","a.evolveAction",function(){var e=$(this).parent(),n=e.data().id,i=o.map.pokemonList.findIndex(function(t){return t.id==n}),a=o.map.pokemonList[i],s=o.map.pokemonList.filter(function(t){return t.pokemonId==a.pokemonId}).length-1,l=inventoryService.getPokemonName(a.pokemonId),r="Are you sure you want to evolve this "+l+"? <br /> You will have <b>"+s+"</b> left.";t(r,function(){ga("send","event","evolve",l),o.ws.emit("evolve_pokemon",{id:n}),o.map.pokemonList.splice(i,1),e.parent().fadeOut()})}),$(".inventory .data").on("click","a.favoriteAction",function(){var t=$(this).parent(),e=t.data().id,n=o.map.pokemonList.findIndex(function(t){return t.id==e}),i=o.map.pokemonList[n];i.favorite=!i.favorite;var a=inventoryService.getPokemonName(i.pokemonId);ga("send","event","favorite",a),$(this).find("img").attr("src","./assets/img/favorite_"+(i.favorite?"set":"unset")+".png"),t.find(".transferAction").toggleClass("hide"),o.ws.emit("favorite_pokemon",{id:e,favorite:i.favorite})}),$(".inventory .data").on("click","a.dropItemAction",function(){var t=$(this).parent(),e=t.data().id,n=inventoryService.getItemName(e),i=t.data().count,a="How many <b>"+n+"</b> would you like to drop?";vex.dialog.confirm({message:a,input:'\n                    <p class="range-field">\n                        <input type="range" name="count" value="1" min="1" max="'+i+"\" onchange=\"$('#display-range').text(this.value)\" />\n                    </p>\n                    Drop: <span id='display-range'>1</span>\n                ",callback:function(a){if(a){var s=parseInt(a.count);ga("send","event","drop_items",n),o.ws.emit("drop_items",{id:e,count:s}),i==s?t.parent().fadeOut():(t.data("count",i-s),t.parent().find(".count").text("x"+(i-s)))}}})}),$(".player").on("pogo:player_update",function(){if(o.player){var t=$(".player");t.find(".playername .value").text(o.user),t.find(".level .value").text(o.player.level);var e=100*(o.player.experience-o.player.prev_level_xp)/(o.player.next_level_xp-o.player.prev_level_xp);t.find(".myprogress .value").css("width",e.toFixed(0)+"%"),t.show()}}),o.config.websocket?(o.map=new Map("map"),o.map.loadContext(),startListenToSocket()):window.location="config.html"}var o={storage:{items:350,pokemon:250},snipping:!1};window.global=o,o.config=window.configService.load(),o.version=o.config.version,document.title+=" - "+o.version,$(function(){inventoryService.init(o.config.locale,e)})}(),function(t,e,o,n,i,a,s){t.GoogleAnalyticsObject=i,t[i]=t[i]||function(){(t[i].q=t[i].q||[]).push(arguments)},t[i].l=1*new Date,a=e.createElement(o),s=e.getElementsByTagName(o)[0],a.async=1,a.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(a,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga");try{"function"==typeof require?(ga("create","UA-81497637-1","auto",{storage:"none",clientId:localStorage.getItem("ga:clientId")}),ga(function(t){localStorage.setItem("ga:clientId",t.get("clientId"))})):ga("create","UA-81497637-1","auto"),ga("set","checkProtocolTask",null),ga("set","location","http://necrovisualizer.nicontoso.eu"),ga("send","pageview"),ga("send","event","version",document.title,document.title)}catch(t){window.ga=function(){}}